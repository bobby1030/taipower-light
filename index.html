<!DOCTYPE html>
<html lang="zh-tw">

<head>
	<title>跳！| 臺電實時備轉容量率資訊民間版 </title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css" />
	<link rel="stylesheet" href="./style.css" />
	<meta property="og:image" content="./screenshot.png" />
	<script src="http://www.taipower.com.tw/loadGraph/loadGraph/data/loadpara.txt"></script>
</head>

<body>
	<div id="content-wrapper">
		<div class="wrapper">
			<h1>實時備轉容量率</h1>
			<div id="info">
				<h2 class="rate"></h2>
				<h2 class="description"></h2>
			</div>
		</div>	
	</div>
	<footer>
		實時用電量、最大供電能力資訊由臺電網站取得，實際資訊請以臺電官網為準。<br/>
		Licensed under MIT. Fork me on <a href="https://github.com/bobby1030/taipower-light" target="_blank">GitHub</a>.
	</footer>
	<iframe id="bg-video" src="
		https://www.youtube.com/embed/sbfQ2Pbf2hE
		?rel=0
		&start=20
		&controls=0
		&showinfo=0
		&autoplay=1
		&loop=1
		&playlist=sbfQ2Pbf2hE
	"></iframe>

	<script>
		var display = function () {
			var currentLoad = parseFloat(loadInfo[0].replace(',', '')) / 10;
			var maxCapacity = parseFloat(loadInfo[2].replace(',', '')) / 10;
			var avaliableCapacity = maxCapacity - currentLoad;
			var rate = avaliableCapacity / currentLoad * 100;
			var status = {};
			if (avaliableCapacity > 50 && avaliableCapacity <= 90) {
				status.text = "限電警戒";
				status.color = "red"
			} else if (avaliableCapacity <= 50) {
				status.text = "限電準備";
				status.color = "black"
			} else if (rate >= 10) {
				status.text = "供電充裕";
				status.color = "green"
			} else if (rate < 10 && rate > 6) {
				status.text = "供電吃緊";
				status.color = "yellow"
			} else if (rate <= 6) {
				status.text = "供電警戒";
				status.color = "orange"
			}

			document.querySelector("h2.rate").innerHTML = rate.toFixed(2) + "%";
			document.querySelector("h2.description").innerHTML = status.text;
			document.querySelector("h2.description").className += ' ' + status.color
		}

		display()
	</script>
</body>

</html>